from sage.all import *
import re

def ec_factor(n: int, B: int):
    while True:
        A = randint(1, n)
        a, b = randint(1, n), randint(1, n)
        B = int((b**2 - a**3 - A*a) % n)
        while not ((4*A**3 + 27*B**2) % n):
            a, b = randint(1, n), randint(1, n)
            B = int((b**2 - a**3 - A*a) % n)

        E = EllipticCurve(IntegerModRing(n), [A, B])
        P = E((a, b))
        Q = P
        for i in range(2, ceil(sqrt(n))):
            try:
                Q1 = i * P
                P = Q1
            except Exception as e:
                x = int(re.search(r"[0-9]+", str(e)).group(0))
                d = gcd(x, n)
                if(d == 1 or d == n):
                    break
                else:
                    return d
            Q = Q1


if __name__ == "__main__":
    for i in [580642391898843192929563856870897799650883152718761762932292482252152591279871421569162037190419036435041797739880389529593674485555792234900969402019055601781662044515999210032698275981631376651117318677368742867687180140048715627160641771118040372573575479330830092989800730105573700557717146251860588802509310534792310748898504394966263819959963273509119791037525504422606634640173277598774814099540555569257179715908642917355365791447508751401889724095964924513196281345665480688029639999472649549163147599540142367575413885729653166517595719991872223011969856259344396899748662101941230745601719730556631637]:
        k = ec_factor(i)
        print(i, k, i//k, k * (i//k))

